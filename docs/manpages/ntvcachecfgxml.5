.\" Automatically generated by Pod::Man version 1.15
.\" Fri Nov 22 12:11:08 2002
.\"
.\" Standard preamble:
.\" ======================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R

.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used
.\" to do unbreakable dashes and therefore won't be available.  \*(C` and
.\" \*(C' expand to `' in nroff, nothing in troff, for use with C<>
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr
.\" for titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and
.\" index entries marked with X<> in POD.  Of course, you'll have to process
.\" the output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it
.\" makes way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.bd B 3
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ======================================================================
.\"
.IX Title "ntvcachecfgxml 5"
.TH ntvcachecfgxml 5 "2.0.0" "2002-11-22" "NexTrieve"
.UC
.SH "NAME"
ntvcachecfgxml \*(-- \s-1XML\s0 format of the ntvcached config file
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The configuration file of \fBntvcached\fR is in \s-1XML\s0 format.
The \s-1DTD\s0 describing the format of this configuration file
can be found in \fIntvdtds\fR\|(5).
.PP
A description of \fBntvcached\fR can be found in \fIntvcached\fR\|(1).
.PP
The \fBntvcached\fR configuration file is implemented as an
<ntv:cacheconfig> container.  This container can contain possibly
several <physicalindex> containers, each describing a \*(L"physical\*(R"
nextrieve text index that is being served by one or more nextrieve
searche servers.  It can also contain an indication of the default
\&\*(L"logical\*(R" index to search, and other miscellaneous configuration
information.
.PP
At the top-level, the <ntv:cacheconfig> container looks like:
.PP
.Vb 8
\&    <ntv:cacheconfig xmlns:ntv="http://www.nextrieve.com/1.0">
\&        <physicalindex name="...">
\&            <logicalindex .../>
\&            ...
\&            <server .../>
\&            ...
\&        </physicalindex>
\&        ...
.Ve
.Vb 1
\&        <defaultlogicalindex.../>
.Ve
.Vb 4
\&        <generalconfig>
\&            ...
\&        </generalconfig>
\&    </ntv:cacheconfig>
.Ve
.Sh "<physicalindex>"
.IX Subsection "<physicalindex>"
.Vb 1
\&    <physicalindex name="physname">
.Ve
One <physicalindex> element is present for every physical nextrieve
text index managed by this caching server.
A \*(L"physical\*(R" text index is simply a directory containing the *.ntv files
for a particular nextrieve text index.
.PP
Each copy of a physical text index is served by one or
more \fBntvsearchd\fR (or \fBntvcached\fR) servers.
.PP
The \fIphysname\fR attribute value is simply used as a tag for various information
printed by \fBntvcached\fR when asked to print its state.
Typically it names the directory where the physical text index is located.
.PP
Inside the <physicalindex> container, several other elements can be present:
.Ip "<\fBlogicalindex name='\f(BIlogname\fB' constraint='\f(BIconstraint\fB'\fR/>" 4
.IX Item "<logicalindex name='logname' constraint='constraint'/>"
This defines a \*(L"logical text index\*(R" that is present in a physical
text index.
.Sp
If there are many small text indexes present, it is frequently more effective to
construct a single physical text index that contains them all, as opposed
to having many small text indexes, each being served separately.
The logical text indexes are discriminated by using a simple constraint
(normally just a single flag value) per logical index.
The constraint is defined here as \fIconstraint\fR.  When a query arrives
for a particular logical text index, \fBntvcached\fR
knows how to augment any user-supplied constraint to restrict
the query to be within the set of documents valid for the given logical
text index.
.Sp
If no constraint attribute is specified for a particular <logicalindex>,
the entire physical text index is searched.
.Sp
The name of this logical text index, \*(L"logname\*(R", can be provided as part of
an incoming query using the
.Sp
.Vb 1
\&    <indexname>logname</indexname>
.Ve
container.  When using \fBntvultralite\fR, an index name can be specified in
the <ntvultralite> container of the resource file using the
.Sp
.Vb 1
\&    <logicalindex name="logname"/>
.Ve
element.
.Sp
There can be multiple <logicalindex> elements present within a single
<physicalindex> container.
.Ip "<\fBserver host='\f(BIaddr:port\fB' maxqueries='\f(BIn\fB'\fR/>" 4
.IX Item "<server host='addr:port' maxqueries='n'/>"
This indicates that a particular nextrieve search or caching server
is listening on the address
and port specified.  This server is expected to be searching on
the appropriate physical text index.
.Sp
There can be multiple <server> elements within a single <physicalindex>
container, normally indicating servers
on different machines that are serving from copies of the same physical
text index.  \fBntvcached\fR will give incoming requests to the server
that is \*(L"least busy\*(R" at the time the request arrives.
.Sp
The \fImaxqueries\fR attribute indicates how many requests can be given
to a particular server without receiving a response.  A default value of
\&\*(L"1\*(R" is used.  Higher values can be used to increase throughput.  Higher
values should be used on machines that are more powerful than others.
.Sh "<defaultlogicalindex>"
.IX Subsection "<defaultlogicalindex>"
.Vb 1
\&    <defaultlogicalindex name='defaultname'/>
.Ve
The name of the default logical text index to use is specified.  If query
\&\s-1XML\s0 arrives that does not contain any <indexname> element
\&\*(L"defaultname\*(R" is used.  If \*(L"defaultname\*(R" is not specified in this case,
an error is returned to the query originator.
.Sh "<generalconfig>"
.IX Subsection "<generalconfig>"
This container contains miscellaneous general configuration information.
The elements permitted inside <generalconfig> are:
.Ip "<\fBconnections clients='\f(BIn\fB' maxreadtime='\f(BIsecs\fB' maxoutstandingqueries='\f(BInout\fB'/\fR" 4
.IX Item "<connections clients='n' maxreadtime='secs' maxoutstandingqueries='nout'/"
The maximum number of simultaneous client connections to \fBntvcached\fR
is restricted to be \*(L"n\*(R".  A default value of 128 is used.
.Sp
The \*(L"maxreadtime\*(R" value is the number of seconds for which a client connection
can be open with no incoming query being received.  A default of 30 seconds
is used.  If this time is passed, the connection is automatically closed.
.Sp
The \*(L"maxoutstandingqueries\*(R" value indicates the maximum number of requests
that can be pending results inside \fBntvcached\fR.  A default value of
100 is used.  If this value is reached, further incoming queries are
blocked until some queries have been served.
.Ip "<\fBcache size='\f(BIn\fB'\fR/>" 4
.IX Item "<cache size='n'/>"
\&\fIn\fR indicates the number of \fIhit lists\fR that will be cached.
A default value of 1000 is used.
.Ip "<\fBlog file='\f(BIlogfile\fB'\fR/>" 4
.IX Item "<log file='logfile'/>"
Indicates the name of a file in which to log messages.  Note that if there
is a problem accessing the caching server configuration file itself, a message
is logged using the logfile (if any) specified in the resource file, or
the \s-1NTV_ERRORLOG\s0 environment variable.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
Example content of a simple caching server configuration file is
as follows:
.PP
.Vb 1
\&    <ntv:cacheconfig xmlns:ntv="http://www.nextrieve.com/1.0">
.Ve
.Vb 7
\&        <physicalindex name="/tmp/test/*.ntv">
\&            <logicalindex name="everything"/>
\&            <logicalindex name="gutenberg" constraint="gutenberg"/>
\&            <logicalindex name="dictionary" constraint="dictionary"/>
\&            <logicalindex name="shakespeare" constraint="shakespeare"/>
\&            <server host="localhost:7777" maxqueries="10"/>
\&        </physicalindex>
.Ve
.Vb 1
\&        <defaultlogicalindex name="everything"/>
.Ve
.Vb 6
\&        <generalconfig>
\&            <connections
\&                    clients="10" maxreadtime="30" maxoutstandingqueries="50"/>
\&            <cache size="1000"/>
\&            <log file="/tmp/caching-errorlog.txt"/>
\&        </generalconfig>
.Ve
.Vb 1
\&    </ntv:cacheconfig>
.Ve
.SH "CAVEATS"
.IX Header "CAVEATS"
As of this nextrieve release it is possible to have multiple logical
text indexes in a single physical text index (discriminated by using
a constraint), but it is not yet possible to perform an extended search
where a single logical text index is split over multiple physical indexes.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
.Vb 1
\&    ntvcached(1), ntvsearch(1), ntvsearchd(1), ntvindex(1)
.Ve
